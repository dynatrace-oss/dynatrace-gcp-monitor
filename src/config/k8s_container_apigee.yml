id: k8s_container
$schema: gcp_schema_v_1_0.json
version: 0.0.1
minDynatraceVersion: 1.199
vars:
- id: filter_conditions
  displayName: Metric query filter for which metrics should be queried
  type: variables
technology:
  name: Google Kubernetes Container Apigee
gcp:
- service: k8s_container
  featureSet: apigee
  gcpMonitoringFilter: var:filter_conditions
  dimensions:
  - value: label:resource.labels.project_id
    key: project_id
    compatibilityModeOnly: true
  - value: label:resource.labels.project_id
    key: gcp.project.id
  - value: label:resource.labels.location
    key: location
    compatibilityModeOnly: true
  - value: label:resource.labels.location
    key: gcp.region
  - value: label:resource.labels.cluster_name
    key: cluster_name
  - value: label:resource.labels.namespace_name
    key: namespace_name
  - value: label:resource.labels.pod_name
    key: pod_name
  - value: label:resource.labels.container_name
    key: container_name
    compatibilityModeOnly: false
  - value: label:resource.labels.container_name
    key: gcp.instance.name
  metrics:
  - value: metric:apigee.googleapis.com/cassandra/clientrequest_latency
    key: cloud.gcp.apigee_googleapis_com.cassandra.clientrequest_latency
    type: gauge
    name: Apigee Cassandra client request latency
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: DOUBLE
      metricKind: GAUGE
      unit: '1'
    dimensions:
    - value: label:metric.labels.scope
      key: scope
    - value: label:metric.labels.unit
      key: unit
  - value: metric:apigee.googleapis.com/cassandra/compaction_pendingtasks
    key: cloud.gcp.apigee_googleapis_com.cassandra.compaction_pendingtasks
    type: gauge
    name: Apigee Cassandra pending compaction tasks
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: INT64
      metricKind: GAUGE
      unit: '1'
    dimensions:
    - value: label:metric.labels.unit
      key: unit
  - value: metric:apigee.googleapis.com/cassandra/jvm_memory_bytes_committed
    key: cloud.gcp.apigee_googleapis_com.cassandra.jvm_memory_bytes_committed
    type: gauge
    name: Apigee Cassandra bytes committed per area
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: DOUBLE
      metricKind: GAUGE
      unit: By
    dimensions:
    - value: label:metric.labels.area
      key: area
  - value: metric:apigee.googleapis.com/cassandra/jvm_memory_bytes_init
    key: cloud.gcp.apigee_googleapis_com.cassandra.jvm_memory_bytes_init
    type: gauge
    name: Apigee Cassandra initial memory bytes
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: DOUBLE
      metricKind: GAUGE
      unit: By
    dimensions:
    - value: label:metric.labels.area
      key: area
  - value: metric:apigee.googleapis.com/cassandra/jvm_memory_bytes_max
    key: cloud.gcp.apigee_googleapis_com.cassandra.jvm_memory_bytes_max
    type: gauge
    name: Apigee Cassandra max bytes of memory
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: DOUBLE
      metricKind: GAUGE
      unit: By
    dimensions:
    - value: label:metric.labels.area
      key: area
  - value: metric:apigee.googleapis.com/cassandra/jvm_memory_bytes_used
    key: cloud.gcp.apigee_googleapis_com.cassandra.jvm_memory_bytes_used
    type: gauge
    name: Apigee Cassandra used JVM memory bytes
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: DOUBLE
      metricKind: GAUGE
      unit: By
    dimensions:
    - value: label:metric.labels.area
      key: area
  - value: metric:apigee.googleapis.com/cassandra/jvm_memory_pool_bytes_committed
    key: cloud.gcp.apigee_googleapis_com.cassandra.jvm_memory_pool_bytes_committed
    type: gauge
    name: Apigee Cassandra bytes committed per memory pool
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: DOUBLE
      metricKind: GAUGE
      unit: By
    dimensions:
    - value: label:metric.labels.pool
      key: pool
  - value: metric:apigee.googleapis.com/cassandra/jvm_memory_pool_bytes_init
    key: cloud.gcp.apigee_googleapis_com.cassandra.jvm_memory_pool_bytes_init
    type: gauge
    name: Apigee Cassandra initial bytes of JVM memory pool
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: DOUBLE
      metricKind: GAUGE
      unit: By
    dimensions:
    - value: label:metric.labels.pool
      key: pool
  - value: metric:apigee.googleapis.com/cassandra/jvm_memory_pool_bytes_max
    key: cloud.gcp.apigee_googleapis_com.cassandra.jvm_memory_pool_bytes_max
    type: gauge
    name: Apigee Cassandra JVM memory pool bytes max
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: DOUBLE
      metricKind: GAUGE
      unit: By
    dimensions:
    - value: label:metric.labels.pool
      key: pool
  - value: metric:apigee.googleapis.com/cassandra/jvm_memory_pool_bytes_used
    key: cloud.gcp.apigee_googleapis_com.cassandra.jvm_memory_pool_bytes_used
    type: gauge
    name: Apigee Cassandra bytes per memory pool
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: DOUBLE
      metricKind: GAUGE
      unit: By
    dimensions:
    - value: label:metric.labels.pool
      key: pool
  - value: metric:apigee.googleapis.com/cassandra/process_cpu_seconds_total
    key: cloud.gcp.apigee_googleapis_com.cassandra.process_cpu_seconds_total
    type: count,delta
    name: Apigee Cassandra user and system CPU in seconds
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: DOUBLE
      metricKind: CUMULATIVE
      unit: s
    dimensions: []
  - value: metric:apigee.googleapis.com/cassandra/process_max_fds
    key: cloud.gcp.apigee_googleapis_com.cassandra.process_max_fds
    type: gauge
    name: Apigee Cassandra process max file descriptors
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: INT64
      metricKind: GAUGE
      unit: '1'
    dimensions: []
  - value: metric:apigee.googleapis.com/cassandra/process_open_fds
    key: cloud.gcp.apigee_googleapis_com.cassandra.process_open_fds
    type: gauge
    name: Apigee Cassandra process open file descriptors
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: INT64
      metricKind: GAUGE
      unit: '1'
    dimensions: []
  - value: metric:apigee.googleapis.com/server/fault_count
    key: cloud.gcp.apigee_googleapis_com.server.fault_count
    type: count,delta
    name: Apigee server fault count
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: INT64
      metricKind: CUMULATIVE
      unit: '1'
    dimensions:
    - value: label:metric.labels.source
      key: source
  - value: metric:apigee.googleapis.com/server/latencies
    key: cloud.gcp.apigee_googleapis_com.server.latencies
    type: count,delta
    name: Apigee server latencies
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: DISTRIBUTION
      metricKind: CUMULATIVE
      unit: ms
    dimensions:
    - value: label:metric.labels.method
      key: method
    - value: label:metric.labels.response_code
      key: response_code
    - value: label:metric.labels.type
      key: type
  - value: metric:apigee.googleapis.com/server/nio
    key: cloud.gcp.apigee_googleapis_com.server.nio
    type: gauge
    name: Apigee server nio
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: INT64
      metricKind: GAUGE
      unit: '1'
    dimensions:
    - value: label:metric.labels.state
      key: state
  - value: metric:apigee.googleapis.com/server/num_threads
    key: cloud.gcp.apigee_googleapis_com.server.num_threads
    type: gauge
    name: Apigee server thread count
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: INT64
      metricKind: GAUGE
      unit: '1'
    dimensions: []
  - value: metric:apigee.googleapis.com/server/request_count
    key: cloud.gcp.apigee_googleapis_com.server.request_count
    type: count,delta
    name: Apigee server request count
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: INT64
      metricKind: CUMULATIVE
      unit: '1'
    dimensions:
    - value: label:metric.labels.method
      key: method
    - value: label:metric.labels.type
      key: type
  - value: metric:apigee.googleapis.com/server/response_count
    key: cloud.gcp.apigee_googleapis_com.server.response_count
    type: count,delta
    name: Apigee server response count
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: INT64
      metricKind: CUMULATIVE
      unit: '1'
    dimensions:
    - value: label:metric.labels.method
      key: method
    - value: label:metric.labels.response_code
      key: response_code
    - value: label:metric.labels.type
      key: type
  - value: metric:apigee.googleapis.com/udca/disk/used_bytes
    key: cloud.gcp.apigee_googleapis_com.udca.disk.used_bytes
    type: gauge
    name: Apigee UDCA disk used bytes
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: DOUBLE
      metricKind: GAUGE
      unit: By
    dimensions:
    - value: label:metric.labels.dataset
      key: dataset
    - value: label:metric.labels.state
      key: state
  - value: metric:apigee.googleapis.com/udca/server/local_file_count
    key: cloud.gcp.apigee_googleapis_com.udca.server.local_file_count
    type: gauge
    name: Apigee UDCA server local file count
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: INT64
      metricKind: GAUGE
      unit: '1'
    dimensions:
    - value: label:metric.labels.dataset
      key: dataset
    - value: label:metric.labels.state
      key: state
  - value: metric:apigee.googleapis.com/udca/server/local_file_latest_ts
    key: cloud.gcp.apigee_googleapis_com.udca.server.local_file_latest_ts
    type: gauge
    name: Apigee UDCA server timestamp difference between current time and latest
      file
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: INT64
      metricKind: GAUGE
      unit: s
    dimensions:
    - value: label:metric.labels.dataset
      key: dataset
    - value: label:metric.labels.state
      key: state
  - value: metric:apigee.googleapis.com/udca/server/local_file_oldest_ts
    key: cloud.gcp.apigee_googleapis_com.udca.server.local_file_oldest_ts
    type: gauge
    name: Apigee UDCA server timestamp difference between current time and oldest
      file
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: INT64
      metricKind: GAUGE
      unit: s
    dimensions:
    - value: label:metric.labels.dataset
      key: dataset
    - value: label:metric.labels.state
      key: state
  - value: metric:apigee.googleapis.com/udca/server/pruned_file_count
    key: cloud.gcp.apigee_googleapis_com.udca.server.pruned_file_count
    type: count,delta
    name: Apigee UDCA pruned file count
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: INT64
      metricKind: CUMULATIVE
      unit: '1'
    dimensions:
    - value: label:metric.labels.dataset
      key: dataset
    - value: label:metric.labels.state
      key: state
  - value: metric:apigee.googleapis.com/udca/server/retry_cache_size
    key: cloud.gcp.apigee_googleapis_com.udca.server.retry_cache_size
    type: gauge
    name: Apigee UDCA outstanding number of entries in retry cache
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: INT64
      metricKind: GAUGE
      unit: '1'
    dimensions:
    - value: label:metric.labels.dataset
      key: dataset
  - value: metric:apigee.googleapis.com/udca/server/total_latencies
    key: cloud.gcp.apigee_googleapis_com.udca.server.total_latencies
    type: count,delta
    name: Apigee UDCA server total latencies
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: DISTRIBUTION
      metricKind: CUMULATIVE
      unit: s
    dimensions:
    - value: label:metric.labels.dataset
      key: dataset
  - value: metric:apigee.googleapis.com/udca/server/upload_latencies
    key: cloud.gcp.apigee_googleapis_com.udca.server.upload_latencies
    type: count,delta
    name: Apigee UDCA server upload latencies
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: DISTRIBUTION
      metricKind: CUMULATIVE
      unit: s
    dimensions:
    - value: label:metric.labels.dataset
      key: dataset
  - value: metric:apigee.googleapis.com/udca/upstream/http_error_count
    key: cloud.gcp.apigee_googleapis_com.udca.upstream.http_error_count
    type: count,delta
    name: Apigee UDCA server HTTP error count
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: INT64
      metricKind: CUMULATIVE
      unit: '1'
    dimensions:
    - value: label:metric.labels.dataset
      key: dataset
    - value: label:metric.labels.service
      key: service
    - value: label:metric.labels.response_code
      key: response_code
  - value: metric:apigee.googleapis.com/udca/upstream/http_latencies
    key: cloud.gcp.apigee_googleapis_com.udca.upstream.http_latencies
    type: count,delta
    name: Apigee UDCA server HTTP latencies
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: DISTRIBUTION
      metricKind: CUMULATIVE
      unit: s
    dimensions:
    - value: label:metric.labels.dataset
      key: dataset
    - value: label:metric.labels.service
      key: service
  - value: metric:apigee.googleapis.com/udca/upstream/uploaded_file_count
    key: cloud.gcp.apigee_googleapis_com.udca.upstream.uploaded_file_count
    type: count,delta
    name: Apigee UDCA uploaded file count
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: INT64
      metricKind: CUMULATIVE
      unit: '1'
    dimensions:
    - value: label:metric.labels.dataset
      key: dataset
  - value: metric:apigee.googleapis.com/udca/upstream/uploaded_file_sizes
    key: cloud.gcp.apigee_googleapis_com.udca.upstream.uploaded_file_sizes
    type: count,delta
    name: Apigee UDCA uploaded file size distribution
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: DISTRIBUTION
      metricKind: CUMULATIVE
      unit: By
    dimensions:
    - value: label:metric.labels.dataset
      key: dataset
  - value: metric:apigee.googleapis.com/upstream/latencies
    key: cloud.gcp.apigee_googleapis_com.upstream.latencies
    type: count,delta
    name: Apigee upstream latencies
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: DISTRIBUTION
      metricKind: CUMULATIVE
      unit: ms
    dimensions:
    - value: label:metric.labels.method
      key: method
    - value: label:metric.labels.response_code
      key: response_code
    - value: label:metric.labels.type
      key: type
  - value: metric:apigee.googleapis.com/upstream/request_count
    key: cloud.gcp.apigee_googleapis_com.upstream.request_count
    type: count,delta
    name: Apigee upstream request count
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: INT64
      metricKind: CUMULATIVE
      unit: '1'
    dimensions:
    - value: label:metric.labels.method
      key: method
    - value: label:metric.labels.type
      key: type
  - value: metric:apigee.googleapis.com/upstream/response_count
    key: cloud.gcp.apigee_googleapis_com.upstream.response_count
    type: count,delta
    name: Apigee upstream response count
    gcpOptions:
      ingestDelay: 180
      samplePeriod: 60
      valueType: INT64
      metricKind: CUMULATIVE
      unit: '1'
    dimensions:
    - value: label:metric.labels.method
      key: method
    - value: label:metric.labels.response_code
      key: response_code
    - value: label:metric.labels.type
      key: type
